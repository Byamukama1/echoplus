<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Echoplus - Smart Investment Platform</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
            * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        :root {
            --primary: #4361ee;
            --primary-light: #4895ef;
            --secondary: #3f37c9;
            --accent: #f72585;
            --success: #4cc9f0;
            --light: #ffffff;
            --light-gray: #f8f9fa;
            --medium-gray: #e9ecef;
            --text: #212529;
            --text-light: #6c757d;
        }

        body {
            background-color: var(--light-gray);
            color: var(--text);
            min-height: 100vh;
            padding-bottom: 70px;
            font-size: 14px; /* Reduced base font size */
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 10px; /* Reduced padding */
        }

        /* Header Styles */
        header {
            padding: 12px 0; /* Reduced padding */
            background-color: var(--light);
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05); /* Lighter shadow */
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 8px; /* Reduced gap */
            font-weight: 700;
            font-size: 1.1rem; /* Reduced font size */
            color: var(--primary);
        }

        .logo-icon {
            width: 32px; /* Reduced size */
            height: 32px; /* Reduced size */
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            border-radius: 8px; /* Reduced radius */
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            position: relative;
            overflow: hidden;
        }

        .logo-icon::before,
        .logo-icon::after {
            content: "";
            position: absolute;
            border-radius: 50%;
            border: 2px solid white;
            opacity: 0.7;
        }

        .logo-icon::before {
            width: 24px; /* Reduced size */
            height: 24px; /* Reduced size */
        }

        .logo-icon::after {
            width: 16px; /* Reduced size */
            height: 16px; /* Reduced size */
        }

        .logo-icon i {
            position: relative;
            z-index: 2;
            font-size: 0.9rem; /* Reduced icon size */
        }

        .user-actions {
            display: flex;
            gap: 8px; /* Reduced gap */
        }

        .action-btn {
            background: var(--light);
            border: 1px solid var(--medium-gray);
            border-radius: 6px; /* Reduced radius */
            padding: 6px 10px; /* Reduced padding */
            font-size: 0.7rem; /* Reduced font size */
            color: var(--text);
            cursor: pointer;
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
            gap: 4px; /* Reduced gap */
        }

        .action-btn:hover {
            background: var(--primary);
            color: white;
            border-color: var(--primary);
        }

        /* Metrics Section */
        .metrics-section {
            padding: 15px 0; /* Reduced padding */
        }

        .metrics-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr); /* Always 2 columns */
            gap: 10px; /* Reduced gap */
            margin-bottom: 15px; /* Reduced margin */
        }

        .metric-card {
            background-color: var(--light);
            border-radius: 8px; /* Reduced radius */
            padding: 12px; /* Reduced padding */
            box-shadow: 0 3px 8px rgba(0, 0, 0, 0.03); /* Lighter shadow */
            border: 1px solid var(--medium-gray);
        }

        .metric-label {
            font-size: 0.7rem; /* Reduced font size */
            color: var(--text-light);
            margin-bottom: 4px; /* Reduced margin */
            display: flex;
            align-items: center;
            gap: 4px; /* Reduced gap */
        }

        .metric-value {
            font-size: 1.1rem; /* Reduced font size */
            font-weight: 700;
            color: var(--primary);
        }

        .metric-trend {
            font-size: 0.65rem; /* Reduced font size */
            color: var(--success);
            margin-top: 3px; /* Reduced margin */
            display: flex;
            align-items: center;
            gap: 2px; /* Reduced gap */
        }

        /* Products Section */
        .products-section {
            margin-top: 8px; /* Reduced margin */
        }

        .section-title {
            font-size: 1.0rem; /* Reduced font size */
            margin-bottom: 12px; /* Reduced margin */
            display: flex;
            align-items: center;
            gap: 6px; /* Reduced gap */
            color: var(--text);
        }

        .products-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr); /* Always 2 columns */
            gap: 12px; /* Reduced gap */
        }

        .product-card {
            background-color: var(--light);
            border-radius: 10px; /* Reduced radius */
            overflow: hidden;
            box-shadow: 0 3px 8px rgba(0, 0, 0, 0.03); /* Lighter shadow */
            border: 1px solid var(--medium-gray);
            transition: all 0.2s ease;
        }

        .product-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08); /* Lighter shadow */
        }

        .product-image {
            height: 100px; /* Reduced height */
            background: linear-gradient(135deg, var(--primary-light), var(--primary));
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
        }

        .product-image img {
            max-width: 75%; /* Slightly smaller */
            max-height: 75%; /* Slightly smaller */
            filter: drop-shadow(0 3px 8px rgba(0,0,0,0.2)); /* Lighter shadow */
            border-radius: 3px; /* Reduced radius */
        }

        .product-badge {
            position: absolute;
            top: 8px; /* Reduced position */
            right: 8px; /* Reduced position */
            background-color: var(--accent);
            color: white;
            padding: 3px 6px; /* Reduced padding */
            border-radius: 12px; /* Reduced radius */
            font-size: 0.6rem; /* Reduced font size */
            font-weight: 600;
        }

        .product-content {
            padding: 12px; /* Reduced padding */
        }

        .product-title {
            font-size: 0.8rem; /* Reduced font size */
            margin-bottom: 6px; /* Reduced margin */
            font-weight: 600;
            color: var(--text);
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .product-price {
            font-size: 0.95rem; /* Reduced font size */
            color: var(--primary);
            font-weight: 700;
            margin-bottom: 8px; /* Reduced margin */
        }

        /* Simplified product layout */
        .simplified-details {
            display: flex;
            flex-direction: column;
            gap: 6px; /* Reduced gap */
            margin-bottom: 12px; /* Reduced margin */
        }

        .simplified-detail {
            display: flex;
            justify-content: space-between;
            font-size: 0.75rem; /* Reduced font size */
        }

        .simplified-label {
            color: var(--text-light);
            font-size: 0.7rem; /* Reduced font size */
        }

        .simplified-value {
            font-weight: 500;
            color: var(--text);
            font-size: 0.75rem; /* Reduced font size */
        }

        .buy-button {
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: white;
            border: none;
            width: 100%;
            padding: 8px; /* Reduced padding */
            border-radius: 6px; /* Reduced radius */
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 5px; /* Reduced gap */
            font-size: 0.75rem; /* Reduced font size */
        }

        .buy-button:hover {
            opacity: 0.9;
            transform: scale(1.02);
        }

        /* Navigation */
        .bottom-nav {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background-color: var(--light);
            display: flex;
            justify-content: space-around;
            padding: 10px 0; /* Reduced padding */
            border-top: 1px solid var(--medium-gray);
            z-index: 100;
            box-shadow: 0 -2px 8px rgba(0, 0, 0, 0.05); /* Lighter shadow */
        }

        .nav-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            font-size: 0.6rem; /* Reduced font size */
            color: var(--text-light);
            transition: color 0.3s;
        }

        .nav-item.active {
            color: var(--primary);
        }

        .nav-item i {
            font-size: 1.0rem; /* Reduced icon size */
            margin-bottom: 2px; /* Reduced margin */
        }

        /* Status bar simulation */
        .status-bar {
            background-color: var(--light);
            padding: 6px 10px; /* Reduced padding */
            display: flex;
            justify-content: space-between;
            font-size: 0.7rem; /* Reduced font size */
            color: var(--text);
            border-bottom: 1px solid var(--medium-gray);
        }

        .status-left, .status-right {
            display: flex;
            align-items: center;
            gap: 3px; /* Reduced gap */
        }

        .status-center {
            font-weight: 600;
            font-size: 0.75rem; /* Reduced font size */
        }

        .earnings-summary {
            background: white;
            border-radius: 8px; /* Reduced radius */
            padding: 12px; /* Reduced padding */
            margin-bottom: 12px; /* Reduced margin */
            box-shadow: 0 2px 6px rgba(0,0,0,0.05); /* Lighter shadow */
            border: 1px solid #eaeaea;
        }

        .summary-title {
            font-size: 0.9rem; /* Reduced font size */
            margin-bottom: 8px; /* Reduced margin */
            color: var(--text-light);
            display: flex;
            align-items: center;
            gap: 6px; /* Reduced gap */
        }

        .summary-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 8px; /* Reduced gap */
        }

        .summary-item {
            display: flex;
            flex-direction: column;
        }

        .summary-value {
            font-size: 1.0rem; /* Reduced font size */
            font-weight: 700;
            color: var(--primary);
        }

        .summary-label {
            font-size: 0.7rem; /* Reduced font size */
            color: var(--text-light);
        }

        /* Firebase connection indicator */
        .firebase-status {
            position: fixed;
            top: 10px;
            right: 10px;
            background: #FFCA28;
            color: #000;
            padding: 5px 10px;
            border-radius: 20px;
            font-size: 0.7rem;
            font-weight: 600;
            z-index: 1000;
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .firebase-status.connected {
            background: #4CAF50;
            color: white;
        }

        .firebase-status i {
            font-size: 0.8rem;
        }
    </style>
    </head>

<body>
    <!-- Header -->
    <header>
  <div class="container">
    <div class="header-content" style="display: flex; flex-direction: column; align-items: center; padding: 20px 0;">

      <!-- Logo and Title -->
      <div class="logo" style="display: flex; align-items: center; gap: 10px; margin-bottom: 10px;">
        <div class="logo-icon">
          <i class="fas fa-wave-square"></i>
        </div>
        <div style="font-size: 20px; font-weight: 600;">ECHOPLUS</div>
      </div>

      <!-- Action Buttons -->
      <div class="user-actions" style="display: flex; gap: 10px;">
        <a href="withdraw.html" class="action-btn" style="
            text-decoration: none;
            color: white;
            background-color: #007bff;
            padding: 6px 14px;
            font-size: 14px;
            border-radius: 6px;
            display: inline-flex;
            align-items: center;
            gap: 6px;
            box-shadow: 0 1px 4px rgba(0,0,0,0.1);
        ">
          <i class="fas fa-arrow-up"></i>
          <span>Withdraw</span>
        </a>

        <a href="deposit.html" class="action-btn" style="
            text-decoration: none;
            color: white;
            background-color: #28a745;
            padding: 6px 14px;
            font-size: 14px;
            border-radius: 6px;
            display: inline-flex;
            align-items: center;
            gap: 6px;
            box-shadow: 0 1px 4px rgba(0,0,0,0.1);
        ">
          <i class="fas fa-arrow-down"></i>
          <span>Deposit</span>
        </a>
      </div>
    </div>
  </div>
</header>

    <!-- Main Content -->
    <main class="container">
        <!-- Earnings Summary -->
        <div class="earnings-summary">
            <div class="summary-grid">
                <div class="summary-item">
                    <div id="todays-earnings" class="summary-value">0</div>
                    <div class="summary-label">Today's Earnings</div>
                </div>
                <div class="summary-item">
                    <div id="uninvested-deposit" class="summary-value">0</div>
                    <div class="summary-label">Uninvested Deposit</div>
                </div>
            </div>
        </div>

        <!-- Metrics Section -->
        <section class="metrics-section">
            <div class="metrics-grid">
                <!-- ... (your existing metric cards) ... -->
            </div>
        </section>

        <!-- Products Section -->
        <section class="products-section">
            <h2 class="section-title">
                <i class="fas fa-mobile-alt"></i>
                <span>Smartphone Investments</span>
            </h2>

            <div class="products-grid">
                <!-- Product 1 -->
                <div class="product-card">
                    <div class="product-image">
                        <img src="https://images.unsplash.com/photo-1595941069915-4ebc5197c14a?crop=entropy&cs=tinysrgb&fit=crop&fm=jpg&h=400&w=600" alt="Budget Smartphone">
                    </div>
                    <div class="product-content">
                        <h3 class="product-title">Value Phone</h3>
                        <div class="product-price">UGX 25,000</div>

                        <div class="simplified-details">
                            <div class="simplified-detail">
                                <span class="simplified-label">Daily Income</span>
                                <span class="simplified-value">UGX 5,000</span>
                            </div>
                            <div class="simplified-detail">
                                <span class="simplified-label">Cycle</span>
                                <span class="simplified-value">80 Days</span>
                            </div>
                            <div class="simplified-detail">
                                <span class="simplified-label">Total Revenue</span>
                                <span class="simplified-value">UGX 400,000</span>
                            </div>
                        </div>

                        <button class="buy-button" data-id="1" data-price="25000" data-title="Value Phone" data-daily="5000" data-cycle="80">
                            <i class="fas fa-shopping-cart"></i>
                            <span>INVEST</span>
                        </button>
                    </div>
                </div>

                <!-- Product 2 -->
                <div class="product-card">
                    <div class="product-image">
                        <img src="https://images.unsplash.com/photo-1511707171634-5f897ff02aa9?crop=entropy&cs=tinysrgb&fit=crop&fm=jpg&h=400&w=600" alt="Entry Smartphone">
                    </div>
                    <div class="product-content">
                        <h3 class="product-title">Standard Phone</h3>
                        <div class="product-price">UGX 50,000</div>

                        <div class="simplified-details">
                            <div class="simplified-detail">
                                <span class="simplified-label">Daily Income</span>
                                <span class="simplified-value">UGX 12,000</span>
                            </div>
                            <div class="simplified-detail">
                                <span class="simplified-label">Cycle</span>
                                <span class="simplified-value">80 Days</span>
                            </div>
                            <div class="simplified-detail">
                                <span class="simplified-label">Total Revenue</span>
                                <span class="simplified-value">UGX 960,000</span>
                            </div>
                        </div>

                        <button class="buy-button" data-id="2" data-price="50000" data-title="Standard Phone" data-daily="12000" data-cycle="80">
                            <i class="fas fa-shopping-cart"></i>
                            <span>INVEST</span>
                        </button>
                    </div>
                </div>

                <!-- Product 3 -->
                <div class="product-card">
                    <div class="product-image">
                        <div class="product-badge">POPULAR</div>
                        <img src="https://images.unsplash.com/photo-1512054502232-10a0a035d672?crop=entropy&cs=tinysrgb&fit=crop&fm=jpg&h=400&w=600" alt="Mid-range Phone">
                    </div>
                    <div class="product-content">
                        <h3 class="product-title">Premium Phone</h3>
                        <div class="product-price">UGX 80,000</div>

                        <div class="simplified-details">
                            <div class="simplified-detail">
                                <span class="simplified-label">Daily Income</span>
                                <span class="simplified-value">UGX 22,500</span>
                            </div>
                            <div class="simplified-detail">
                                <span class="simplified-label">Cycle</span>
                                <span class="simplified-value">80 Days</span>
                            </div>
                            <div class="simplified-detail">
                                <span class="simplified-label">Total Revenue</span>
                                <span class="simplified-value">UGX 2,800,000</span>
                            </div>
                        </div>

                        <button class="buy-button" data-id="3" data-price="80000" data-title="Premium Phone" data-daily="22500" data-cycle="80">
                            <i class="fas fa-shopping-cart"></i>
                            <span>INVEST</span>
                        </button>
                    </div>
                </div>

                <!-- Product 4 -->
                <div class="product-card">
                    <div class="product-image">
                        <img src="https://images.unsplash.com/photo-1584438784894-089d6a62b8fa?crop=entropy&cs=tinysrgb&fit=crop&fm=jpg&h=400&w=600" alt="Advanced Phone">
                    </div>
                    <div class="product-content">
                        <h3 class="product-title">Advanced Phone</h3>
                        <div class="product-price">UGX 120,000</div>

                        <div class="simplified-details">
                            <div class="simplified-detail">
                                <span class="simplified-label">Daily Income</span>
                                <span class="simplified-value">UGX 35,000</span>
                            </div>
                            <div class="simplified-detail">
                                <span class="simplified-label">Cycle</span>
                                <span class="simplified-value">80 Days</span>
                            </div>
                            <div class="simplified-detail">
                                <span class="simplified-label">Total Revenue</span>
                                <span class="simplified-value">UGX 5,200,000</span>
                            </div>
                        </div>

                        <button class="buy-button" data-id="4" data-price="120000" data-title="Advanced Phone" data-daily="35000" data-cycle="80">
                            <i class="fas fa-shopping-cart"></i>
                            <span>INVEST</span>
                        </button>
                    </div>
                </div>

                <!-- Product 5 -->
                <div class="product-card">
                    <div class="product-image">
                        <div class="product-badge">HOT</div>
                        <img src="https://images.unsplash.com/photo-1592750475338-74b7b21085ab?crop=entropy&cs=tinysrgb&fit=crop&fm=jpg&h=400&w=600" alt="Premium Phone">
                    </div>
                    <div class="product-content">
                        <h3 class="product-title">Business Phone</h3>
                        <div class="product-price">UGX 280,000</div>

                        <div class="simplified-details">
                            <div class="simplified-detail">
                                <span class="simplified-label">Daily Income</span>
                                <span class="simplified-value">UGX 65,000</span>
                            </div>
                            <div class="simplified-detail">
                                <span class="simplified-label">Cycle</span>
                                <span class="simplified-value">80 Days</span>
                            </div>
                            <div class="simplified-detail">
                                <span class="simplified-label">Total Revenue</span>
                                <span class="simplified-value">UGX 6,400,000</span>
                            </div>
                        </div>

                        <button class="buy-button" data-id="5" data-price="280000" data-title="Business Phone" data-daily="65000" data-cycle="80">
                            <i class="fas fa-shopping-cart"></i>
                            <span>INVEST</span>
                        </button>
                    </div>
                </div>
                
                <!-- Product 6 -->
                <div class="product-card">
                    <div class="product-image">
                        <img src="https://images.unsplash.com/photo-1605236453806-6ff36851218e?crop=entropy&cs=tinysrgb&fit=crop&fm=jpg&h=400&w=600" alt="Pro Phone">
                    </div>
                    <div class="product-content">
                        <h3 class="product-title">Pro Phone</h3>
                        <div class="product-price">UGX 360,000</div>

                        <div class="simplified-details">
                            <div class="simplified-detail">
                                <span class="simplified-label">Daily Income</span>
                                <span class="simplified-value">UGX 85,000</span>
                            </div>
                            <div class="simplified-detail">
                                <span class="simplified-label">Cycle</span>
                                <span class="simplified-value">80 Days</span>
                            </div>
                            <div class="simplified-detail">
                                <span class="simplified-label">Total Revenue</span>
                                <span class="simplified-value">UGX 8,800,000</span>
                            </div>
                        </div>

                        <button class="buy-button" data-id="6" data-price="360000" data-title="Pro Phone" data-daily="85000" data-cycle="80">
                            <i class="fas fa-shopping-cart"></i>
                            <span>INVEST</span>
                        </button>
                    </div>
                </div>

                <!-- Product 7 -->
                <div class="product-card">
                    <div class="product-image">
                        <div class="product-badge">VIP</div>
                        <img src="https://images.unsplash.com/photo-1610792516307-ea5acbd9c4b7?crop=entropy&cs=tinysrgb&fit=crop&fm=jpg&h=400&w=600" alt="Business Phone">
                    </div>
                    <div class="product-content">
                        <h3 class="product-title">Luxury Phone</h3>
                        <div class="product-price">UGX 650,000</div>

                        <div class="simplified-details">
                            <div class="simplified-detail">
                                <span class="simplified-label">Daily Income</span>
                                <span class="simplified-value">UGX 110,000</span>
                            </div>
                            <div class="simplified-detail">
                                <span class="simplified-label">Cycle</span>
                                <span class="simplified-value">80 Days</span>
                            </div>
                            <div class="simplified-detail">
                                <span class="simplified-label">Total Revenue</span>
                                <span class="simplified-value">UGX 14,400,000</span>
                            </div>
                        </div>

                        <button class="buy-button" data-id="7" data-price="650000" data-title="Luxury Phone" data-daily="110000" data-cycle="80">
                            <i class="fas fa-shopping-cart"></i>
                            <span>INVEST</span>
                        </button>
                    </div>
                </div>

                <!-- Product 8 -->
                <div class="product-card">
                    <div class="product-image">
                        <div class="product-badge">PREMIUM</div>
                        <img src="https://images.unsplash.com/photo-1600086827875-a9c8d0a51d2b?crop=entropy&cs=tinysrgb&fit=crop&fm=jpg&h=400&w=600" alt="Luxury Phone">
                    </div>
                    <div class="product-content">
                        <h3 class="product-title">Flagship Phone</h3>
                        <div class="product-price">UGX 1,000,000</div>

                        <div class="simplified-details">
                            <div class="simplified-detail">
                                <span class="simplified-label">Daily Income</span>
                                <span class="simplified-value">UGX 300,000</span>
                            </div>
                            <div class="simplified-detail">
                                <span class="simplified-label">Cycle</span>
                                <span class="simplified-value">80 Days</span>
                            </div>
                            <div class="simplified-detail">
                                <span class="simplified-label">Total Revenue</span>
                                <span class="simplified-value">UGX 24,000,000</span>
                            </div>
                        </div>

                        <button class="buy-button" data-id="8" data-price="1000000" data-title="Flagship Phone" data-daily="300000" data-cycle="80">
                            <i class="fas fa-shopping-cart"></i>
                            <span>INVEST</span>
                        </button>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <!-- Bottom Navigation -->
<nav class="bottom-nav" style="position: fixed; bottom: 0; left: 0; right: 0; background: #fff; border-top: 1px solid #ddd; display: flex; justify-content: space-around; padding: 10px 0; z-index: 1000;">
  <a href="index.html" class="nav-item" style="text-align: center; color: #333; text-decoration: none;">
    <i class="fas fa-home"></i>
    <span style="display: block; font-size: 12px;">Home</span>
  </a>
  <a href="products.html" class="nav-item" style="text-align: center; color: #333; text-decoration: none;">
    <i class="fas fa-chart-pie"></i>
    <span style="display: block; font-size: 12px;">Products</span>
  </a>
  <a href="team.html" class="nav-item" style="text-align: center; color: #333; text-decoration: none;">
    <i class="fas fa-gift"></i>
    <span style="display: block; font-size: 12px;">Team</span>
  </a>
  <a href="account.html" class="nav-item" style="text-align: center; color: #333; text-decoration: none;">
    <i class="fas fa-user"></i>
    <span style="display: block; font-size: 12px;">Account</span>
  </a>
</nav>

    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js"></script>

    <script>
        // Firebase configuration
        const firebaseConfig = {
            apiKey: "AIzaSyChCWhXOdNDl-8mc367bPmRBnNnVJsQVVU",
            authDomain: "echoplus-e9606.firebaseapp.com",
            projectId: "echoplus-e9606",
            storageBucket: "echoplus-e9606.appspot.com",
            messagingSenderId: "674979906304",
            appId: "1:674979906304:web:7864593a26f571a268a9e5",
            measurementId: "G-TYC9PSQFR2"
        };

        // Initialize Firebase
        firebase.initializeApp(firebaseConfig);
        const auth = firebase.auth();
        const db = firebase.firestore();
        
        // UI Elements
        const firebaseStatus = document.createElement('div');
        firebaseStatus.className = 'firebase-status';
        firebaseStatus.innerHTML = '<i class="fas fa-sync-alt"></i> <span>Connecting...</span>';
        document.body.appendChild(firebaseStatus);

        // Session timeout variables
        const SESSION_DURATION = 60 * 60 * 1000; // 1 hour in milliseconds
        let sessionCheckInterval;
        
        // Show notification function
        function showNotification(message, isError = false) {
            // Remove any existing notification
            const existingNotif = document.querySelector('.notification');
            if (existingNotif) existingNotif.remove();
            
            const notification = document.createElement('div');
            notification.className = 'notification';
            notification.textContent = message;
            
            if (isError) {
                notification.style.backgroundColor = '#ff6b6b';
            } else {
                notification.style.backgroundColor = '#4caf50';
            }
            
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.classList.add('show');
            }, 10);
            
            setTimeout(() => {
                notification.classList.remove('show');
                setTimeout(() => {
                    notification.remove();
                }, 300);
            }, 3000);
        }
        
        // Update Firebase status
        function updateFirebaseStatus(connected) {
            if (connected) {
                firebaseStatus.innerHTML = '<i class="fas fa-check-circle"></i> <span>Connected</span>';
                firebaseStatus.classList.add('connected');
            } else {
                firebaseStatus.innerHTML = '<i class="fas fa-exclamation-circle"></i> <span>Disconnected</span>';
                firebaseStatus.classList.remove('connected');
            }
        }
        
        // Monitor connection status
        db.enableNetwork()
            .then(() => {
                updateFirebaseStatus(true);
            })
            .catch((error) => {
                updateFirebaseStatus(false);
                console.error("Firebase connection error:", error);
            });

        // Set auth persistence to SESSION and initialize session timeout
        auth.setPersistence(firebase.auth.Auth.Persistence.SESSION)
            .then(() => {
                auth.onAuthStateChanged(user => {
                    if (!user) {
                        window.location.href = 'login.html';
                    } else {
                        // Set login time if not already set
                        if (!localStorage.getItem('loginTime')) {
                            localStorage.setItem('loginTime', Date.now());
                        }
                        
                        // Start session timeout checks
                        clearInterval(sessionCheckInterval);
                        sessionCheckInterval = setInterval(checkSessionTimeout, 60000); // Check every minute
                        
                        updateDashboard();
                    }
                });
            })
            .catch((error) => {
                console.error("Persistence error:", error);
                window.location.href = 'login.html';
            });

        // Update dashboard with user data
        async function updateDashboard() {
            const user = auth.currentUser;
            if (!user) return;

            try {
                // 1. Get user document
                const userRef = db.collection('users').doc(user.uid);
                const userDoc = await userRef.get();
                
                if (!userDoc.exists) {
                    // Create user document if it doesn't exist
                    await userRef.set({
                        email: user.email || '',
                        phone: '',
                        totalDeposit: 0,
                        totalEarnings: 0,
                        totalWithdrawn: 0,
                        activeInvestments: 0,
                        uninvestedDeposit: 0,
                        todaysEarnings: 0
                    });
                    showNotification("User account created successfully!");
                }
                
                const userData = userDoc.data();
                
                // Update UI with the latest data
                document.getElementById('todays-earnings').textContent = 
                    `UGX ${(userData.todaysEarnings || 0).toLocaleString()}`;
                
                document.getElementById('uninvested-deposit').textContent = 
                    `UGX ${(userData.uninvestedDeposit || 0).toLocaleString()}`;
                
                document.getElementById('total-deposit').textContent = 
                    `UGX ${(userData.totalDeposit || 0).toLocaleString()}`;
                
                document.getElementById('total-earnings').textContent = 
                    `UGX ${(userData.totalEarnings || 0).toLocaleString()}`;
                
                document.getElementById('total-withdrawn').textContent = 
                    `UGX ${(userData.totalWithdrawn || 0).toLocaleString()}`;
                
                document.getElementById('active-investments').textContent = 
                    userData.activeInvestments || 0;
                
                showNotification("Dashboard updated successfully!");
            } catch (error) {
                console.error("Dashboard update error:", error);
                showNotification(`Error: ${error.message}`, true);
            }
        }

        // Handle investment purchases
        async function handleInvestment(event) {
            const button = event.currentTarget;
            button.disabled = true;
            
            try {
                const productId = button.dataset.id;
                const price = parseInt(button.dataset.price);
                const title = button.dataset.title;
                const dailyIncome = parseInt(button.dataset.daily);
                const cycle = parseInt(button.dataset.cycle);
                const totalRevenue = dailyIncome * cycle;

                const user = auth.currentUser;
                if (!user) {
                    showNotification('Please login first', true);
                    window.location.href = 'login.html';
                    return;
                }

                // Get user data
                const userRef = db.collection('users').doc(user.uid);
                const userDoc = await userRef.get();
                
                if (!userDoc.exists) {
                    throw new Error('User account not found');
                }

                const userData = userDoc.data();
                const uninvested = userData.uninvestedDeposit || 0;

                if (uninvested < price) {
                    showNotification('Insufficient funds. Please deposit more money.', true);
                    return;
                }

                // Create investment document in products collection
                await db.collection('products').add({
                    userId: user.uid,
                    productType: title,
                    productPrice: price,
                    dailyIncome: dailyIncome,
                    totalCycle: cycle,
                    remainingDays: cycle,
                    amountEarnedSoFar: 0,
                    totalRevenue: totalRevenue,
                    status: 'active',
                    startDate: firebase.firestore.FieldValue.serverTimestamp()
                });
                             
                // Update user document
                await userRef.update({
                    uninvestedDeposit: firebase.firestore.FieldValue.increment(-price),
                    activeInvestments: firebase.firestore.FieldValue.increment(1)
                });
                
                showNotification('Investment successful!');
                updateDashboard();
            } catch (error) {
                console.error("Investment error:", error);
                showNotification(`Error: ${error.message}`, true);
            } finally {
                button.disabled = false;
            }
        }


        // Check and handle session timeout
        function checkSessionTimeout() {
            const loginTime = localStorage.getItem('loginTime');
            if (!loginTime) return;
            
            const now = Date.now();
            if (now - parseInt(loginTime) > SESSION_DURATION) {
                // Session expired
                auth.signOut().then(() => {
                    localStorage.removeItem('loginTime');
                    showNotification("Session expired. Please log in again.", true);
                    setTimeout(() => {
                        window.location.href = 'login.html';
                    }, 2000);
                });
            }
        }

        // Attach events after DOM is loaded
        document.addEventListener('DOMContentLoaded', () => {
            const buyButtons = document.querySelectorAll('.buy-button');
            buyButtons.forEach(btn => {
                btn.addEventListener('click', handleInvestment);
            });
            
            // Cleanup on page unload
            window.addEventListener('beforeunload', () => {
                clearInterval(sessionCheckInterval);
            });
        });
    </script>
</body>
</html>